<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Processar Arquivo CSV</title>
<!-- Referência ao arquivo JavaScript -->
    <link rel="stylesheet" href="css/styles.css"> <!-- Referência ao arquivo CSS -->
</head>
<body>
<h2>Processar Arquivo CSV</h2>
<form id="csvForm">
    <label for="delimiter">Digite o delimitador (, ; |):</label>
    <input type="text" id="delimiter" name="delimiter" required>
    <br><br>
    <label for="csvFile">Escolha um arquivo CSV:</label>
    <input type="file" id="csvFile" name="csvFile" accept=".csv" required>
    <br><br>
    <button type="submit">Processar</button>
</form>

<div id="output"></div>
</body>
<script>

    document.getElementById('csvForm').addEventListener('submit', function (event) {
    event.preventDefault();

    document.getElementById('output').innerHTML = '';

    var fileInput = document.getElementById('csvFile');
    var file = fileInput.files[0];
    if (!file) {
        alert('Por favor, selecione um arquivo CSV.');
        return;
    }

    var reader = new FileReader();
    reader.onload = function (event) {
        var csvData = event.target.result;

        var delimiter = detectDelimiter(csvData);
        if (!delimiter) {
            alert('Não foi possível detectar o delimitador padrão do CSV.');
            return;
        }

        var userDelimiter = document.getElementById('delimiter').value;

        var modifiedCsvData = csvData.replace(new RegExp(escapeRegExp(delimiter), 'g'), userDelimiter);

        var lines = modifiedCsvData.split('\n');

        var output = document.getElementById('output');
        lines.forEach(function (line) {
            var rowDiv = document.createElement('div');
            rowDiv.textContent = line;
            output.appendChild(rowDiv);
        });
    };

    reader.readAsText(file);
});

function detectDelimiter(csvData) {
    var delimiters = [',', ';', '|'];
    for (var i = 0; i < delimiters.length; i++) {
        if (csvData.indexOf(delimiters[i]) !== -1) {
            return delimiters[i];
        }
    }
    return null;
}


function escapeRegExp(string) {
    return string.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
}


</script>
</html>